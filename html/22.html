<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>FuelPHPがOpAuth対応になったのでfacebookログインをしてみる | DASALOG -ださろぐ</title>
<link rel="stylesheet" href="http://dasalog.eg2mix.com/wp-content/themes/renownedmint/style.css" type="text/css" />
<link rel="pingback" href="http://dasalog.eg2mix.com/xmlrpc.php" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="alternate" type="application/rss+xml" title="DASALOG -ださろぐ &raquo; フィード" href="http://dasalog.eg2mix.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="DASALOG -ださろぐ &raquo; コメントフィード" href="http://dasalog.eg2mix.com/comments/feed/" />

            <script type="text/javascript">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.3 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-26824357-1']);
				            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
			<link rel="alternate" type="application/rss+xml" title="DASALOG -ださろぐ &raquo; FuelPHPがOpAuth対応になったのでfacebookログインをしてみる のコメントのフィード" href="http://dasalog.eg2mix.com/fuel-advent2013-opauth/feed/" />
<link rel='stylesheet' id='iqfmcss-css'  href='http://dasalog.eg2mix.com/wp-content/plugins/inquiry-form-creator/css/inquiry-form.css?ver=0.7' type='text/css' media='all' />
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-includes/js/comment-reply.min.js?ver=3.8'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/inquiry-form-creator/js/ajaxzip2/ajaxzip2.js?ver=2.10'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/inquiry-form-creator/js/jquery.upload.js?ver=1.0.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://dasalog.eg2mix.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://dasalog.eg2mix.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='AWS SDK for PHP2を使ってPHPスクリプトからEMRのジョブフローを作成＆実行する' href='http://dasalog.eg2mix.com/aws-sdk2-emr/' />
<meta name="generator" content="WordPress 3.8" />
<link rel='shortlink' href='http://dasalog.eg2mix.com/?p=523' />
<script>AjaxZip2.JSONDATA = "http://dasalog.eg2mix.com/wp-content/plugins/inquiry-form-creator/js/ajaxzip2/data";</script>
<!-- All in One SEO Pack 2.1.1 by Michael Torbert of Semper Fi Web Design[249,318] -->
<link rel="canonical" href="http://dasalog.eg2mix.com/fuel-advent2013-opauth/" />
<!-- /all in one seo pack -->
<!-- BEGIN: WP Social Bookmarking Light -->
<script type="text/javascript" src="http://connect.facebook.net/ja_JP/all.js#xfbml=1"></script>
<style type="text/css">
.wp_social_bookmarking_light{
    border: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
}
.wp_social_bookmarking_light div{
    float: left !important;
    border: 0 !important;
    padding: 0 !important;
    margin: 0 5px 0px 0 !important;
    height: 23px !important;
    text-indent: 0 !important;
}
.wp_social_bookmarking_light img{
    border: 0 !important;
    padding: 0;
    margin: 0;
    vertical-align: top !important;
}
.wp_social_bookmarking_light_clear{
    clear: both !important;
}
.wsbl_twitter{
    width: 100px;
}</style>
<!-- END: WP Social Bookmarking Light -->
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<body class="single single-post postid-523 single-format-standard">
<div id="container">
	<div id="header">
		<div id="headings">
			<h1><a href="http://dasalog.eg2mix.com/">DASALOG -ださろぐ</a></h1>
			<h2>システム開発者からコーヒー屋への道。</h2>
		</div>
		<div id="movement">
			<div id="searchbox">
				<form role="search" method="get" action="http://dasalog.eg2mix.com">
					<div id="search-input-text-wrapper"><input id="search-input-text" type="text" name="s" value="" class="input-text" /></div>
					<div id="search-input-submit-wrapper"><input id="search-input-submit" type="image" src="http://dasalog.eg2mix.com/wp-content/themes/renownedmint/images/button.png" value="Search" class="input-submit" /></div>
				</form>
			</div>
			<ul id="navigation">
<li class="page_item page-item-19"><a href="http://dasalog.eg2mix.com/author/">author</a></li>
			</ul>
		</div>
	</div>	<div id="content_wrapper">
		<div id="content">
			<div class="navigation">
			<div class="alignleft">&laquo; <a href="http://dasalog.eg2mix.com/aws-sdk2-emr/" rel="prev">AWS SDK for PHP2を使ってPHPスクリプトからEMRのジョブフローを作成＆実行する</a></div>
			<div class="alignright"></div>
		</div>
		<div class="post-523 post type-post status-publish format-standard hentry category-fuelphp category-php" id="post-523">
			<h2 class="post-title-single">FuelPHPがOpAuth対応になったのでfacebookログインをしてみる</h2>
			<div class="post-date-single">12月 22nd, 2013 at 14:42</div>
			<div class="entry">
				<p><a href="http://atnd.org/events/45096" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://atnd.org']);">FuelPHP Advent Calendar2013</a>参加記事です。<br />
21日目は@madmamorさんの<a title="FuelPHPをRocketeerで自動デプロイしてみる。マイグレーションとPHPUnitも実行してみる。" href="http://madroom-project.blogspot.jp/2013/12/fac20131221.html" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://madroom-project.blogspot.jp']);" target="_blank">FuelPHPをRocketeerで自動デプロイしてみる。マイグレーションとPHPUnitも実行してみる。</a>でした。</p>
<p>昨年のアドベントカレンダーでは主にPhil Sturgeon氏がメンテされていたNinjAuthというOAuth認証パッケージを使用して簡単にログイン認証が行えるパッケージを作成したのですが、FuelPHP1.6.1からNinjAuthに代わりOpAuthに対応したパッケージが標準で入るようになったので、今年はそちらでログイン連携を行う最小限の方法を紹介します。ざっくりとした作業量比較としては、インストール作業自体はNinjAuthより楽に行えますが、コントローラー、ビューのサンプルなどは付属してないので、そのあたりはまるっと書く必要があるので一手間ある感じです。<br />
とりあえず動かすところまでなので、バリデーションの処理やコントローラーでのハンドリングを実際のアプリケーションで作りこむと良い感じになると思われます。</p>
<p>環境：FuelPHP1.7.1、caomposerはインストール済、DBはセットアップ済みの想定</p>
<p>それでは各ステップごとにいってみましょう。</p>
<h2>各configの設定</h2>
<p>fuel/app/config/config.php<br />
always_loadにauthとormを追加</p>
<pre class="brush: php; title: ; notranslate" title="">
	 'always_load'  =&gt; array(

		/**
		 * These packages are loaded on Fuel's startup.
		 * You can specify them in the following manner:
		 *
		 * array('auth'); // This will assume the packages are in PKGPATH
		 *
		 * // Use this format to specify the path to the package explicitly
		 * array(
		 *     array('auth'	=&gt; PKGPATH.'auth/')
		 * );
		 */
		 'packages'  =&gt; array(
		 	'auth',
		 	'orm',
		 ),
</pre>
<p>packages/auth/configからopauth.phpをコピーしてきてapp/config以下に配置<br />
opauth.phpのStrategyを追加。今回はFacebookのみ。</p>
<pre class="brush: php; title: ; notranslate" title="">
	'Strategy' =&gt; [
		'Facebook' =&gt; [
			'app_id' =&gt; 'xxxxx',
			'app_secret' =&gt; 'xxxxxx',
		],
	]
</pre>
<h2>composerで必要なパッケージをインストール</h2>
<p>composer.jsonのrequireに以下を追加</p>
<pre class="brush: jscript; title: ; notranslate" title="">
    &quot;opauth/opauth&quot;: &quot;0.4.*&quot;,
    &quot;opauth/facebook&quot;: &quot;dev-master&quot;,
</pre>
<p>プロジェクトのルートディレクトリで</p>
<pre class="brush: bash; title: ; notranslate" title="">
composer update
</pre>
<p>を実行すると必要なopauth本体とfacebookストラテジがインストールされる。</p>
<h2>マイグレーションを実行して必要なテーブルを作成</h2>
<pre class="brush: bash; title: ; notranslate" title="">
php oil r migrate --packages=auth
</pre>
<p>を実行すると、下記のテーブルが作成される。</p>
<pre>+------------------------+
| migration              |
| users                  |
| users_clients          |
| users_providers        |
| users_scopes           |
| users_sessions         |
| users_sessionscopes    |
+------------------------+</pre>
<h2>コントローラーの作成</h2>
<p>auth用のコントローラーを作成します。コントローラー名に特に縛りはありませんが、今回はController_Authという名前で作成します。<br />
Using Auth in your applicationのサンプルをコピペしつつ、動くように調整してみます。</p>
<p>fuel/app/classes/controller/auth.php</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
use Fuel\Core\Controller;
use Fuel\Core\Log;

class Controller_Auth extends Controller {

	public function action_oauth($provider = null)
	{
		// bail out if we don't have an OAuth provider to call
		if ($provider === null)
		{
			Log::error(__('login-no-provider-specified'));
			\Response::redirect_back();
		}

		// load Opauth, it will load the provider strategy and redirect to the provider
		\Auth_Opauth::forge();
	}

	public function action_logout()
	{
		// remove the remember-me cookie, we logged-out on purpose
		\Auth::dont_remember_me();

		// logout
		\Auth::logout();

		// and go back to where you came from (or the application
		// homepage if no previous page can be determined)
		\Response::redirect_back();
	}

	public function action_callback()
	{

		// Opauth can throw all kinds of nasty bits, so be prepared
		try
		{
			// get the Opauth object
			$opauth = \Auth_Opauth::forge(false);

			// and process the callback
			$status = $opauth-&gt;login_or_register();

			// fetch the provider name from the opauth response so we can display a message
			$provider = $opauth-&gt;get('auth.provider', '?');

			// deal with the result of the callback process
			switch ($status)
			{
				// a local user was logged-in, the provider has been linked to this user
				case 'linked':
					// inform the user the link was succesfully made
					// and set the redirect url for this status
					$url = '/';
					break;

					// the provider was known and linked, the linked account as logged-in
				case 'logged_in':
					// inform the user the login using the provider was succesful
					// and set the redirect url for this status

					$url = '/';
					break;

					// we don't know this provider login, ask the user to create a local account first
				case 'register':
					// inform the user the login using the provider was succesful, but we need a local account to continue
					// and set the redirect url for this status
					$url = 'auth/register';
					break;

					// we didn't know this provider login, but enough info was returned to auto-register the user
				case 'registered':
					// inform the user the login using the provider was succesful, and we created a local account
					// and set the redirect url for this status
					$url = '/';
					break;

				default:
					throw new \FuelException('Auth_Opauth::login_or_register() has come up with a result that we dont know how to handle.');
			}

			// redirect to the url set
			\Response::redirect($url);
		}

		// deal with Opauth exceptions
		catch (\OpauthException $e)
		{
			Log::error($e-&gt;getMessage());
			\Response::redirect_back();
		}

		// catch a user cancelling the authentication attempt (some providers allow that)
		catch (\OpauthCancelException $e)
		{
			// you should probably do something a bit more clean here...
			exit('It looks like you canceled your authorisation.'.\Html::anchor('users/oath/'.$provider, 'Click here').' to try again.');
		}

	}

	public function action_register()
	{

		// create the registration fieldset
		$form = \Fieldset::forge('registerform');

		// add a csrf token to prevent CSRF attacks
		$form-&gt;form()-&gt;add_csrf();

		// and populate the form with the model properties
		$form-&gt;add_model('Model\\Auth_User');

		// add the fullname field, it's a profile property, not a user property
		$form-&gt;add_after('fullname', __('login.form.fullname'), array(), array(), 'username')-&gt;add_rule('required');

		// add a password confirmation field
		$form-&gt;add_after('confirm', __('login.form.confirm'), array('type' =&gt; 'password'), array(), 'password')-&gt;add_rule('required');

		// make sure the password is required
		$form-&gt;field('password')-&gt;add_rule('required');

		// and new users are not allowed to select the group they're in (duh!)
		$form-&gt;disable('group_id');

		// since it's not on the form, make sure validation doesn't trip on its absence
		$form-&gt;field('group_id')-&gt;delete_rule('required')-&gt;delete_rule('is_numeric');

		// fetch the oauth provider from the session (if present)
		$provider = \Session::get('auth-strategy.authentication.provider', false);

		// if we have provider information, create the login fieldset too
		if ($provider)
		{
			// disable the username, it was passed to us by the Oauth strategy
			$form-&gt;field('username')-&gt;set_attribute('readonly', true);

			// create an additional login form so we can link providers to existing accounts
			$login = \Fieldset::forge('loginform');
			$login-&gt;form()-&gt;add_csrf();
			$login-&gt;add_model('Model\\Auth_User');

			// we only need username and password
			$login-&gt;disable('group_id')-&gt;disable('email');

			// since they're not on the form, make sure validation doesn't trip on their absence
			$login-&gt;field('group_id')-&gt;delete_rule('required')-&gt;delete_rule('is_numeric');
			$login-&gt;field('email')-&gt;delete_rule('required')-&gt;delete_rule('valid_email');
		}

		// was the registration form posted?
		if (\Input::method() == 'POST')
		{
			// was the login form posted?
			if ($provider and \Input::post('login'))
			{
				// check the credentials.
				if (\Auth::instance()-&gt;login(\Input::param('username'), \Input::param('password')))
				{
					// get the current logged-in user's id
					list(, $userid) = \Auth::instance()-&gt;get_user_id();

					// so we can link it to the provider manually
					$this-&gt;link_provider($userid);

					// logged in, go back where we came from,
					// or the the user dashboard if we don't know
					\Response::redirect_back('dashboard');
				}
				else
				{
					// login failed, show an error message
					Log::error(__('login.failure'));
				}
			}

			// was the registration form posted?
			elseif (\Input::post('register'))
			{
				// validate the input
				$form-&gt;validation()-&gt;run();

				// if validated, create the user
				if ( ! $form-&gt;validation()-&gt;error())
				{
					try
					{
						// call Auth to create this user
						$created = \Auth::create_user(
								$form-&gt;validated('username'),
								$form-&gt;validated('password'),
								$form-&gt;validated('email'),
								\Config::get('application.user.default_group', 1),
								array(
										'fullname' =&gt; $form-&gt;validated('fullname'),
								)
						);

						// if a user was created succesfully
						if ($created)
						{
							// inform the user

							// link new user
							$this-&gt;link_provider($created);

							// and go back to the previous page, or show the
							// application dashboard if we don't have any
							\Response::redirect_back('/');
						}
						else
						{
							// oops, creating a new user failed?
							Log::error(__('login.account-creation-failed'));
						}
					}

					// catch exceptions from the create_user() call
					catch (\SimpleUserUpdateException $e)
					{
						// duplicate email address
						if ($e-&gt;getCode() == 2)
						{
							Log::error(__('login.email-already-exists'));
						}

						// duplicate username
						elseif ($e-&gt;getCode() == 3)
						{
							Log::error(__('login.username-already-exists'));
						}

						// this can't happen, but you'll never know...
						else
						{
							Log::error($e-&gt;getMessage());
						}
					}
				}
			}

			// validation failed, repopulate the form from the posted data
			$form-&gt;repopulate();
		}
		else
		{
			// get the auth-strategy data from the session (created by the callback)
			$user_hash = \Session::get('auth-strategy.user', array());

			// populate the registration form with the data from the provider callback
			$form-&gt;populate(array(
					'username' =&gt; \Arr::get($user_hash, 'nickname'),
					'fullname' =&gt; \Arr::get($user_hash, 'name'),
					'email' =&gt; \Arr::get($user_hash, 'email'),
			));
		}
		$form-&gt;add('register', '', array('type'=&gt;'hidden', 'value' =&gt; '1'));
		$form-&gt;add('submit', '', array('type'=&gt;'submit', 'value' =&gt; 'submit'));

		// pass the fieldset to the form, and display the new user registration view
		return \View::forge('login/registration')-&gt;set('form', $form-&gt;build(), false)-&gt;set('login', isset($login) ? $login : null, false);
	}

	protected function link_provider($userid)
	{
		// do we have an auth strategy to match?
		if ($authentication = \Session::get('auth-strategy.authentication', array()))
		{
			// don't forget to pass false, we need an object instance, not a strategy call
			$opauth = \Auth_Opauth::forge(false);

			// call Opauth to link the provider login with the local user
			$insert_id = $opauth-&gt;link_provider(array(
					'parent_id' =&gt; $userid,
					'provider' =&gt; $authentication['provider'],
					'uid' =&gt; $authentication['uid'],
					'access_token' =&gt; $authentication['access_token'],
					'secret' =&gt; $authentication['secret'],
					'refresh_token' =&gt; $authentication['refresh_token'],
					'expires' =&gt; $authentication['expires'],
					'created_at' =&gt; time(),
			));
		}
	}

}

</pre>
<p>action_oauthが起点となるアクションとなり、ここから各サービスへリダイレクトされます。<br />
コールバックはconfigで特に指定していない場合、同コントローラのaction_callbackアクションに帰ってきますので、action_callback内で処理を判定します。<br />
未登録の場合はauth/registerに飛ばしてユーザー登録を行わせ、登録が完了した時点でlink_providerでユーザーの紐付けを行うようになっています。</p>
<h2>ユーザー登録用ビューの作成</h2>
<p>今回はfieldsetを使っているので、単純にechoしてとりあえずフォームを出してみましょう。</p>
<p>fuel/app/views/login/registration.php</p>
<pre class="brush: php; title: ; notranslate" title="">

&lt;?php
echo $form;
</pre>
<h2>確認してみる</h2>
<p>コントローラ、ビューまで作成して/auth/oauth/facebookにアクセスするとfacebook認証が行われ、未登録であればregisterに飛ばされます。</p>
<p><a href="http://dasalog.eg2mix.com/wp-content/uploads/2013/12/96546dc21b175a2f8fe84494c082970c.png" ><img class="alignnone  wp-image-541" alt="登録フォーム" src="http://dasalog.eg2mix.com/wp-content/uploads/2013/12/96546dc21b175a2f8fe84494c082970c.png" width="484" height="292" /></a></p>
<p>登録を完了し、再度同じURLからアクセスするとログインとなり、セッションにログイン情報が格納されます。</p>
<p><a href="http://dasalog.eg2mix.com/wp-content/uploads/2013/12/d9eca634fc0770132699d574a0cf1f94.png" ><img class="alignnone size-large wp-image-542" alt="セッション情報" src="http://dasalog.eg2mix.com/wp-content/uploads/2013/12/d9eca634fc0770132699d574a0cf1f94-800x188.png" width="800" height="188" /></a></p>
<p>なお、各OAuthプロバイダから取得したトークンなどの情報はusers_providersテーブルに格納されていますので、こちらを利用してfacebookへの登録や、twitterへの投稿などを行う処理を個別に実装出来ます。</p>
<div class='wp_social_bookmarking_light'><div class="wsbl_hatena_button"><a href="http://b.hatena.ne.jp/entry/http://dasalog.eg2mix.com/fuel-advent2013-opauth/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://b.hatena.ne.jp']);" class="hatena-bookmark-button" data-hatena-bookmark-title="FuelPHPがOpAuth対応になったのでfacebookログインをしてみる" data-hatena-bookmark-layout="standard" title="このエントリーをはてなブックマークに追加"> <img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="http://b.st-hatena.com/js/bookmark_button_wo_al.js" charset="utf-8" async="async"></script></div><div class="wsbl_facebook_like"><fb:like href="http://dasalog.eg2mix.com/fuel-advent2013-opauth/" send="false" layout="button_count" width="100" show_faces="false" action="like" colorscheme="light" font=""></fb:like></div><div class="wsbl_twitter"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url=http%3A%2F%2Fdasalog.eg2mix.com%2Ffuel-advent2013-opauth%2F&amp;text=FuelPHP%E3%81%8COpAuth%E5%AF%BE%E5%BF%9C%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%A7facebook%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%92%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B&amp;via=EGMC&amp;lang=ja&amp;count=horizontal" style="width:130px; height:20px;"></iframe></div></div><br class='wp_social_bookmarking_light_clear' /><div class='yarpp-related yarpp-related-none'>
<p>No related posts.</p>
</div>
												<p class="postmetadata alt">
					<small>
						In <a href="http://dasalog.eg2mix.com/category/php/fuelphp/" title="fuelphp の投稿をすべて表示" rel="category tag">fuelphp</a>, <a href="http://dasalog.eg2mix.com/category/php/" title="php の投稿をすべて表示" rel="category tag">php</a>.
													You can <a href="#respond">leave a response</a>, or <a href="http://dasalog.eg2mix.com/fuel-advent2013-opauth/trackback/" rel="trackback">trackback</a> from your site.
											</small>
				</p>
			</div>
		</div>
		<h3 id="comments">One Response to &#8220;FuelPHPがOpAuth対応になったのでfacebookログインをしてみる&#8221;</h3>
	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
	<ol class="commentlist">
			<li class="pingback even thread-even depth-1" id="comment-2201">
				<div id="div-comment-2201" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href="http://to-developer.com/blog/?p=960" onclick="javascript:_gaq.push(['_trackEvent','outbound-commentauthor','http://to-developer.com']);"  rel='external nofollow' class='url'>[FuelPHP]Heroku(PaaS)でFuelPHP環境(PHP5.3 + MySQL + Apatch)を構築する | Memorandum blog</a></cite> <span class="says">より:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://dasalog.eg2mix.com/fuel-advent2013-opauth/#comment-2201">
			2013-12-23 01:13</a>		</div>

		<p>[&#8230;] FuelPHP Advent Calendar 2013の23日目です。昨日は、@egmcさんの「FuelPHPがOpAuth対応になったのでfacebookログインをしてみる」でした。 [&#8230;]</p>

		<div class="reply">
			<a class='comment-reply-link' href='/fuel-advent2013-opauth/?replytocom=2201#respond' onclick='return addComment.moveForm("div-comment-2201", "2201", "respond", "523")'>返信</a>		</div>
				</div>
		</li><!-- #comment-## -->
	</ol>
	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
 <div id="respond">
<h3>Leave a Reply</h3>
<div class="cancel-comment-reply">
	<small><a rel="nofollow" id="cancel-comment-reply-link" href="/fuel-advent2013-opauth/#respond" style="display:none;">返信をキャンセルする。</a></small>
</div>
<form action="http://dasalog.eg2mix.com/wp-comments-post.php" method="post" id="commentform">
<p><input type="text" name="author" id="author" value="" size="22" tabindex="1" aria-required='true' />
<label for="author"><small>Name (required)</small></label></p>
<p><input type="text" name="email" id="email" value="" size="22" tabindex="2" aria-required='true' />
<label for="email"><small>Mail (will not be published) (required)</small></label></p>
<p><input type="text" name="url" id="url" value="" size="22" tabindex="3" />
<label for="url"><small>Website</small></label></p>
<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>
<p><small><strong>XHTML:</strong> You can use these tags: <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></small></p>
<p><input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment" />
<input type='hidden' name='comment_post_ID' value='523' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p>
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="c187a4213c" /></p></form>
</div>
			</div>
	</div>
<div style="clear: both;"></div> <!-- sometimes .navigation breaks the layout without this -->
</div><!-- /container -->
<div id="footer_wrapper">
	<div id="footer">
		<div id="column-1">
			<h4>Archives</h4>
			<div class="floatitems">
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2013/12/'>2013年12月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2013/09/'>2013年9月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2013/03/'>2013年3月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2012/12/'>2012年12月</a>&nbsp;(2)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2012/11/'>2012年11月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2012/09/'>2012年9月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2012/05/'>2012年5月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2012/03/'>2012年3月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2012/02/'>2012年2月</a>&nbsp;(2)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2011/12/'>2011年12月</a>&nbsp;(1)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2011/11/'>2011年11月</a>&nbsp;(4)</div>
				<div class="floatitem"><a href='http://dasalog.eg2mix.com/2011/07/'>2011年7月</a>&nbsp;(1)</div>
			</div><!-- /floatitems -->
		</div><!-- /column-1 -->
		<div id="column-2">
			<h4>Categories</h4>
			<ul class="floatitems">
	<li class="cat-item cat-item-38"><a href="http://dasalog.eg2mix.com/category/aws/" title="aws に含まれる投稿をすべて表示">aws</a> (1)
</li>
	<li class="cat-item cat-item-37"><a href="http://dasalog.eg2mix.com/category/emr/" title="emr に含まれる投稿をすべて表示">emr</a> (1)
</li>
	<li class="cat-item cat-item-36"><a href="http://dasalog.eg2mix.com/category/event/" title="event に含まれる投稿をすべて表示">event</a> (1)
</li>
	<li class="cat-item cat-item-32"><a href="http://dasalog.eg2mix.com/category/php/fuelphp/" title="fuelphp に含まれる投稿をすべて表示">fuelphp</a> (4)
</li>
	<li class="cat-item cat-item-33"><a href="http://dasalog.eg2mix.com/category/javascript/" title="JavaScript に含まれる投稿をすべて表示">JavaScript</a> (1)
</li>
	<li class="cat-item cat-item-6"><a href="http://dasalog.eg2mix.com/category/misc/" title="misc に含まれる投稿をすべて表示">misc</a> (3)
</li>
	<li class="cat-item cat-item-5"><a href="http://dasalog.eg2mix.com/category/php/" title="php に含まれる投稿をすべて表示">php</a> (13)
</li>
	<li class="cat-item cat-item-19"><a href="http://dasalog.eg2mix.com/category/service/" title="service に含まれる投稿をすべて表示">service</a> (2)
</li>
	<li class="cat-item cat-item-8"><a href="http://dasalog.eg2mix.com/category/env/" title="環境 に含まれる投稿をすべて表示">環境</a> (8)
</li>
			</ul><!-- /floatitems -->
		</div><!-- /column-2 -->
		<div id="column-3">
						<h4>Site Information</h4>
			<ul id="site_info">
			<li>Content &copy; 2013 <a href="http://dasalog.eg2mix.com">DASALOG -ださろぐ</a> except where otherwise noted.</li>
			<li>Powered by <a href="http://www.wordpress.org" target="_blank">WordPress</a>.<br />Theme is <a href="http://renownedmedia.com/blog/renownedmint-wordpress-theme/" target="_blank">RenownedMint</a> by <a href="http://renownedmedia.com" target="_blank">Renowned Media</a>.</li>
			</ul>
					</div><!-- /column-3 -->
	</div><!-- /footer -->
</div><!-- /footer_wrapper -->
</div><!-- /container -->
<!-- Powered by WPtouch: 3.1.5 --><!-- BEGIN: WP Social Bookmarking Light -->
<!-- END: WP Social Bookmarking Light -->
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushClojure.js?ver=20090602'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=20091003'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushLatex.js?ver=20090613'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushMatlabKey.js?ver=20091209'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushObjC.js?ver=20091207'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushR.js?ver=20100919'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js?ver=3.0.83c'></script>
<script type='text/javascript' src='http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.83c'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83c";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://dasalog.eg2mix.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeRDark.css?ver=3.0.83c";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = 'ソースを表示';
	SyntaxHighlighter.config.strings.help = 'SyntaxHighlighterについて';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = '指定のブラシが見つかりませんでした: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'HTMLスクリプトのオプションのためにブラシが構成されませんでした: ';
	SyntaxHighlighter.defaults['light'] = true;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
</body>
</html>